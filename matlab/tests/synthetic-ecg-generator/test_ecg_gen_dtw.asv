close all
clear
clc

load('params_00000', 'params'); params = params{1};

p.alpha = params.a;
p.b = params.b;
p.theta = params.theta;
p.theta0 = 0;
p.f = 70/60;
p.f_deviations = 0.01;
p.delta_alpha = 0.01;
p.delta_theta = 0.01;
p.delta_b = 0.01;
warping_order = 3;
T = 10.0;
fs = 1000;
N = round(T*fs);
[ecg, phi] = ecg_gen_dtw(N, fs, params, phase_bins, warping_order);


time = (0 : N-1) / fs;

figure;
hold on
plot(time, ecg)
plot(time, ph)